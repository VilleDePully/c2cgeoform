<div class="list-grid">

  <div id="toolbar">
    <a class="btn btn-primary btn-new"
       href="{{request.route_url('c2cgeoform_item', action='edit', id='new')}}"
       >{{_('New')}}</a>
  </div>

  <table id="grid" class="table table-condensed table-hover table-striped">
  </table>

  <script type="text/javascript">
  $(function() {

    const namespace = '{{ request.registry.package_name }}';

    $('#grid').bootstrapTable({
      height: $(window).height() - $('nav').height() - 30,
      url: "{{request.route_url('c2cgeoform_grid')}}",

      toolbar: "#toolbar",
      search: true,
      showRefresh: true,
      showColumns: true,

      pagination: true,
      sidePagination: 'server',
      pageSize: 25,
      pageList: [10, 25, 50, 100, 'All'],

      uniqueId: '_id_',
      columns: [
        {
          field: 'actions',
          searchable: false,
          sortable: false,
          switchable: false,
          class: 'actions',
          formatter: function(value, row, index, field) {
            var content = '\
              <div class="btn-group">\
                <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" data-target="item-' + row._id_ + '-actions" aria-haspopup="true" aria-expanded="false">\
                  <span class="caret"></span>\
                </button>\
                <ul id="item-' + row._id_ + '-actions" class="dropdown-menu">';

            row['actions'].forEach(function(action) {
              content += '\
                <li>\
                  <a class="c2cgeoform-item-action ' + action['name'] + ' ' + action['css_class'] + '"\
                     href="' + action['url'] + '">\
                     <span class="' + action['icon'] + '"></span>\
                     ' + action['label'] + '\
                  </a>\
                </li>';
            });

            content += '\
                </ul>\
              </div>';

            return content
            return value;
          }
        },
        {% for field in list_fields %}
        {
          field: '{{field.id()}}',
          title: '{{field.label()}}',
          sortable: '{{'true' if field.sortable() else 'false'}}',
          class: '{{field.id()}}',
          formatter: function(value, row, index, field) {
            return value;
          }
        },
        {% endfor %}
      ]
    });

  });
  </script>
</div>
